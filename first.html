<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quick Introduction &mdash; PaPy 1.0.6 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PaPy 1.0.6 documentation" href="index.html" />
    <link rel="next" title="Architecture" href="architecture.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="architecture.html" title="Architecture"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PaPy 1.0.6 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="quick-introduction">
<h1>Quick Introduction<a class="headerlink" href="#quick-introduction" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Parallel features of <strong>PaPy</strong> do <strong>not</strong> work in the interactive
interpreter. This is a limitation of the Python <tt class="docutils literal"><span class="pre">multiprocessing</span></tt> module.</p>
</div>
<p>This part of the documentation is all about creating a valid <strong>PaPy</strong> workflow.</p>
<p>Creating a workflow invovles several steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Writing worker functions (the functions in the nodes)</li>
<li>Creating <tt class="docutils literal"><span class="pre">Worker</span></tt> instances (to specify worker function parameters)</li>
<li>(optionally) creating <tt class="docutils literal"><span class="pre">NuMap</span></tt> instances to represent parallel
computational resources.</li>
<li>Creating <tt class="docutils literal"><span class="pre">Piper</span></tt> instances (to specify how/where to evaluate the workers)</li>
<li>Creating a <tt class="docutils literal"><span class="pre">Dagger</span></tt> instance (to specify the workflow connections)</li>
</ol>
</div></blockquote>
<p>After construction a workflow can be deployed (or run) by connecting it to input
data and retrieving batches of results.</p>
<p>Workflows exist in two very distinct states before and after they are started.
Those states correspond to the &#8220;construction-time&#8221; and &#8220;run-time&#8221; of a workflow
lifecycle. At &#8220;creation-time&#8221; functions are defined (written or imported) and
the the data-flow is defined by connecting functions by directed pipes. At run
time data is actually &#8220;pumped&#8221; through the pipeline. A pipeline can be saved
and loaded as a python script.</p>
<div class="section" id="the-workflow-graph">
<h2>The Workflow Graph<a class="headerlink" href="#the-workflow-graph" title="Permalink to this headline">¶</a></h2>
<p>In <tt class="docutils literal"><span class="pre">PaPy</span></tt> a workflow is a directed acyclic graph. The direction of the graph
is defined by the data flow (pipes) between the data-processing units (nodes,
<tt class="docutils literal"><span class="pre">Pipers</span></tt>). <tt class="docutils literal"><span class="pre">PaPy</span></tt> pipelines can be branched i.e. two downstream <tt class="docutils literal"><span class="pre">Pipers</span></tt>
might consume input from the same upstream <tt class="docutils literal"><span class="pre">Piper</span></tt> or one down-stream
<tt class="docutils literal"><span class="pre">Piper</span></tt> consumes data from several upstream <tt class="docutils literal"><span class="pre">Pipers</span></tt>. <tt class="docutils literal"><span class="pre">Pipers</span></tt>, which
consume (are connected to) data from outside the directed  acyclic graph are
input <tt class="docutils literal"><span class="pre">Pipers</span></tt>, while <tt class="docutils literal"><span class="pre">Pipers</span></tt> to which no other <tt class="docutils literal"><span class="pre">Pipers</span></tt> are connected to
are output <tt class="docutils literal"><span class="pre">Pipers</span></tt>. <tt class="docutils literal"><span class="pre">PaPy</span></tt> supports pipelines with multiple inputs and
outputs, also several input nodes can consume the same external data.</p>
</div>
<div class="section" id="workflow-execution">
<h2>Workflow Execution<a class="headerlink" href="#workflow-execution" title="Permalink to this headline">¶</a></h2>
<p>Workflows process data items either in parallel or layzily one after another.
Distributed evaluation is enabled by the <tt class="docutils literal"><span class="pre">numap</span></tt> package that provides the
<tt class="docutils literal"><span class="pre">NuMap</span></tt> object. Instances of this object represent computational resources
(pools of local and/or remote processes) that are assigned to processing nodes.
It is possible that multiple processing nodes share a single resource pool.</p>
</div>
<div class="section" id="creating-a-workflow">
<h2>Creating a workflow<a class="headerlink" href="#creating-a-workflow" title="Permalink to this headline">¶</a></h2>
<p>Our first workflow</p>
<div class="section" id="writing-a-worker-function">
<h3>Writing a worker function<a class="headerlink" href="#writing-a-worker-function" title="Permalink to this headline">¶</a></h3>
<p><strong>PaPy</strong> imposes restrictions on the inputs and outputs of a worker function.
Further we recommend a generic way to construct a pipeline:</p>
<div class="highlight-python"><div class="highlight"><pre>input_iterator -&gt; input_piper -&gt; ... processing pipers ... -&gt; output_piper
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">input_piper</span></tt> should transform input data items into a specific Python
objects. Processing pipers should manipulate or transform this objects finally
the <tt class="docutils literal"><span class="pre">output_piper</span></tt> should be used to store the output of the workflow
persistently i.e. it should return <tt class="docutils literal"><span class="pre">None</span></tt>. <strong>PaPy</strong> provides useful functions
to create input/output pipers.</p>
<p>We will start by writing the simples possible function it will do nothing, but
return the input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">pass_input</span><span class="p">(</span><span class="n">inbox</span><span class="p">):</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="n">inbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">input</span>
</pre></div>
</div>
<p>This function can only be used in a <tt class="docutils literal"><span class="pre">Piper</span></tt> that has only one input i.e. it
uses only the first element of the &#8220;inbox&#8221; <tt class="docutils literal"><span class="pre">tuple</span></tt>. A function with two
input values could be used at a point in a workflow where two branches join.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">merge_inputs</span><span class="p">(</span><span class="n">inbox</span><span class="p">):</span>
    <span class="n">input1</span> <span class="o">=</span> <span class="n">inbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">input2</span> <span class="o">=</span> <span class="n">inbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-a-worker-function-which-takes-arguments">
<h3>Writing a worker function which takes arguments<a class="headerlink" href="#writing-a-worker-function-which-takes-arguments" title="Permalink to this headline">¶</a></h3>
<p>A function can be written to take additional arguments (with or without default
values). In the first example the first element in the inbox is multiplied by a
constant factor specified as the number argument. In the second example an
arithmetical operation will be done on two numbers as specified by the operation
argument.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">multiply_by</span><span class="p">(</span><span class="n">inbox</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="n">inbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="nb">input</span> <span class="o">*</span> <span class="n">number</span>
    <span class="k">return</span> <span class="n">output</span>

<span class="k">def</span> <span class="nf">calculator</span><span class="p">(</span><span class="n">inbox</span><span class="p">,</span> <span class="n">operation</span><span class="p">):</span>
    <span class="n">input1</span> <span class="o">=</span> <span class="n">inbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">input2</span> <span class="o">=</span> <span class="n">inbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&#39;add&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">input1</span> <span class="o">+</span> <span class="n">input2</span>
    <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&#39;subtract&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">input1</span> <span class="o">-</span> <span class="n">input2</span>
    <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&#39;multiply&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">input1</span> <span class="o">*</span> <span class="n">input2</span>
    <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&#39;divide&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">input1</span> <span class="o">/</span> <span class="n">input2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s">&#39;error&#39;</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>The additional arguments for these functions are specified when a <tt class="docutils literal"><span class="pre">Worker</span></tt> is
constructed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">multiply_by_2</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">multiply_by</span><span class="p">,</span> <span class="n">number</span> <span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">calculate_sum</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">calculator</span><span class="p">,</span> <span class="n">operation</span> <span class="o">=</span><span class="s">&quot;sum&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The argument names need not to be given:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">multiply_by_3</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">multiply_by</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">calculate_product</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">calculator</span><span class="p">,</span> <span class="s">&quot;multiply&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If a worker is constructed from multiple functions i.e. &#8220;sum the two
inputs and multiply the result by 2&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre># positional arguments
sum_and_multiply_by_2 = Worker((calculator, multiply_by), \
                               ((&#39;sum&#39;,),   (3,))):
# keyworded arguments
sum_and_multiply_by_2 = Worker((calculator, multiply_by), \
                                kwargs = \
                               ({&#39;operation&#39;:&#39;sum&#39;}, {&#39;number&#39;:3}))
</pre></div>
</div>
<p>In the last example the second argument given is in the first version a
tuple of tuples which are the positional arguments for the function or
as in the second example a tuple of dictionaries with named arguments.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Quick Introduction</a><ul>
<li><a class="reference internal" href="#the-workflow-graph">The Workflow Graph</a></li>
<li><a class="reference internal" href="#workflow-execution">Workflow Execution</a></li>
<li><a class="reference internal" href="#creating-a-workflow">Creating a workflow</a><ul>
<li><a class="reference internal" href="#writing-a-worker-function">Writing a worker function</a></li>
<li><a class="reference internal" href="#writing-a-worker-function-which-takes-arguments">Writing a worker function which takes arguments</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="architecture.html"
                        title="next chapter">Architecture</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/first.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="architecture.html" title="Architecture"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">PaPy 1.0.6 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Marcin Cieslik.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>